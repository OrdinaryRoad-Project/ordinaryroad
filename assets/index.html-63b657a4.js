import{_ as l}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as c,c as p,a as n,b as s,d as t,e}from"./app-20fab0ff.js";const o={},u=e('<h1 id="livechatclient弹幕客户端" tabindex="-1"><a class="header-anchor" href="#livechatclient弹幕客户端" aria-hidden="true">#</a> LiveChatClient弹幕客户端</h1><p><img src="https://img.shields.io/github/license/OrdinaryRoad-Project/ordinaryroad-live-chat-client" alt="license" loading="lazy"> <img src="https://img.shields.io/github/v/release/OrdinaryRoad-Project/ordinaryroad-live-chat-client" alt="release" loading="lazy"> <img src="https://img.shields.io/maven-central/v/tech.ordinaryroad/live-chat-client" alt="Maven Central" loading="lazy"></p>',2),d={href:"https://github.com/OrdinaryRoad-Project/ordinaryroad-live-chat-client/issues/new/choose",target:"_blank",rel:"noopener noreferrer"},k=n("br",null,null,-1),r={href:"https://pd.qq.com/s/3id0n7fvs",target:"_blank",rel:"noopener noreferrer"},m=n("br",null,null,-1),b={href:"https://github.com/orgs/OrdinaryRoad-Project/projects/1",target:"_blank",rel:"noopener noreferrer"},h=e('<ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-0" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-0"> B站</label><ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-1" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-1"> BilibiliLiveChatClient</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-2" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-2"> 支持 cookie</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-3" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-3"> 支持 短房间id</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-4" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-4"> 支持 弹幕发送</label></li></ul></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-5" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-5"> 斗鱼</label><ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-6" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-6"> DouyuLiveChatClient</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-7" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-7"> 支持 cookie</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-8" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-8"> 支持 短房间id</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-9" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-9"> 支持 弹幕发送</label></li></ul></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-10" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-10"> 虎牙</label><ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-11" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-11"> DouyuLiveChatClient</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-12" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-12"> 支持 cookie（发送弹幕时需要）</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-13" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-13"> 支持 短房间id（支持字符串房间号，例如<code>bagea</code>）</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-14" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-14"> 支持 弹幕发送</label></li></ul></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-15" disabled="disabled"><label class="task-list-item-label" for="task-item-15"> 抖音</label><ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-16" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-16"> DouyinLiveChatClient</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-17" disabled="disabled"><label class="task-list-item-label" for="task-item-17"> 支持 cookie</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-18" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-18"> 支持 短房间id（支持字符串房间号）</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-19" disabled="disabled"><label class="task-list-item-label" for="task-item-19"> 支持 弹幕发送（暂未搞懂签名算法）</label></li></ul></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-20" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-20"> 快手</label><ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-21" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-21"> KuaishouLiveChatClient</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-22" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-22"> 支持 cookie</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-23" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-23"> 支持 短房间id（支持字符串房间号）</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-24" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-24"> 支持 弹幕发送</label></li></ul></li></ul><hr><p>Live room WebSocket chat client</p><ul><li>Feature 0: Netty</li><li>Feature 1: 消息中的未知属性统一放到单独的MAP中</li><li>Feature 2: 支持自动重连</li><li>Feature 3: 支持同时监听多个直播间</li><li>Feature 4: 支持直播间短id</li><li>Feature 5: 支持弹幕发送</li><li>Feature 6: 内置收到弹幕、收到礼物、收到醒目留言、用户入房回调</li></ul>',4),g={id:"⭐barragefly——让弹幕飞-基于该项目的一个弹幕转发、过滤、处理平台",tabindex:"-1"},v=n("a",{class:"header-anchor",href:"#⭐barragefly——让弹幕飞-基于该项目的一个弹幕转发、过滤、处理平台","aria-hidden":"true"},"#",-1),y={href:"https://barragefly.ordinaryroad.tech/",target:"_blank",rel:"noopener noreferrer"},f=e(`<h2 id="_0-原理" tabindex="-1"><a class="header-anchor" href="#_0-原理" aria-hidden="true">#</a> 0 原理</h2><p>直接人工抓取浏览器的WebSocket二进制流，然后分析模拟浏览器的行为；这样做的好处是不需要进行开发者认证，代价就是没有官方文档，分析过程比较费时费力，并且需要适配不同平台的流程变化（一般不会有大变化）</p><p>以后可能会考虑支持平台的开放协议</p><h2 id="_1-安装" tabindex="-1"><a class="header-anchor" href="#_1-安装" aria-hidden="true">#</a> 1 安装</h2><blockquote><p>JDK ≥ 8</p></blockquote><h3 id="b站" tabindex="-1"><a class="header-anchor" href="#b站" aria-hidden="true">#</a> B站</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>tech.ordinaryroad<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>live-chat-client-bilibili<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 参考github release版本，不需要前缀\`v\` --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${ordinaryroad-live-chat-client.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="斗鱼" tabindex="-1"><a class="header-anchor" href="#斗鱼" aria-hidden="true">#</a> 斗鱼</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>tech.ordinaryroad<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>live-chat-client-douyu<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 参考github release版本，不需要前缀\`v\` --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${ordinaryroad-live-chat-client.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="虎牙" tabindex="-1"><a class="header-anchor" href="#虎牙" aria-hidden="true">#</a> 虎牙</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>tech.ordinaryroad<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>live-chat-client-huya<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 参考github release版本，不需要前缀\`v\` --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${ordinaryroad-live-chat-client.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="抖音" tabindex="-1"><a class="header-anchor" href="#抖音" aria-hidden="true">#</a> 抖音</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>tech.ordinaryroad<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>live-chat-client-douyin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 参考github release版本，不需要前缀\`v\` --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${ordinaryroad-live-chat-client.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="快手" tabindex="-1"><a class="header-anchor" href="#快手" aria-hidden="true">#</a> 快手</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>tech.ordinaryroad<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>live-chat-client-kuaishou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 参考github release版本，不需要前缀\`v\` --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${ordinaryroad-live-chat-client.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-使用" tabindex="-1"><a class="header-anchor" href="#_2-使用" aria-hidden="true">#</a> 2 使用</h2><blockquote><p>测试类包含了多种样例，可供参考</p></blockquote><h3 id="_2-0-不同平台的cmd定义" tabindex="-1"><a class="header-anchor" href="#_2-0-不同平台的cmd定义" aria-hidden="true">#</a> 2.0 不同平台的CMD定义</h3>`,18),_={href:"https://github.com/OrdinaryRoad-Project/ordinaryroad-live-chat-client/blob/main/live-chat-clients/live-chat-client-bilibili/src/main/java/tech/ordinaryroad/live/chat/client/bilibili/constant/BilibiliCmdEnum.java",target:"_blank",rel:"noopener noreferrer"},x={href:"https://github.com/OrdinaryRoad-Project/ordinaryroad-live-chat-client/blob/main/live-chat-clients/live-chat-client-douyu/src/main/java/tech/ordinaryroad/live/chat/client/douyu/constant/DouyuCmdEnum.java",target:"_blank",rel:"noopener noreferrer"},C={href:"https://github.com/OrdinaryRoad-Project/ordinaryroad-live-chat-client/blob/main/live-chat-clients/live-chat-client-huya/src/main/java/tech/ordinaryroad/live/chat/client/huya/constant/HuyaCmdEnum.java",target:"_blank",rel:"noopener noreferrer"},M={href:"https://github.com/OrdinaryRoad-Project/ordinaryroad-live-chat-client/blob/main/live-chat-clients/live-chat-client-douyin/src/main/java/tech/ordinaryroad/live/chat/client/douyin/constant/DouyinCmdEnum.java",target:"_blank",rel:"noopener noreferrer"},I={href:"https://github.com/OrdinaryRoad-Project/ordinaryroad-live-chat-client/blob/main/live-chat-clients/live-chat-client-kuaishou/src/main/java/tech/ordinaryroad/live/chat/client/kuaishou/protobuf/PayloadTypeOuterClass.java",target:"_blank",rel:"noopener noreferrer"},j=e(`<p>可以重写<code>onCmdMsg(收到的所有CMD消息)</code>或<code>onOtherCmdMsg(框架未处理的CMD消息)</code>回调方法，判断CMD来监听框架已经定义的CMD类型</p><p>如果要监听的消息枚举类中未定义，可以考虑重写<code>onUnknownCmdMsg(未知CMD消息)</code>方法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onOtherCmdMsg</span><span class="token punctuation">(</span><span class="token class-name">BilibiliCmdEnum</span> cmd<span class="token punctuation">,</span> <span class="token class-name">ICmdMsg</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BilibiliCmdEnum</span><span class="token punctuation">&gt;</span></span> cmdMsg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>cmd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token constant">GUARD_BUY</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// 有人上舰</span>
                <span class="token class-name">SendSmsReplyMsg</span> sendSmsReplyMsg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SendSmsReplyMsg</span><span class="token punctuation">)</span> cmdMsg<span class="token punctuation">;</span>
                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">case</span> <span class="token constant">SUPER_CHAT_MESSAGE_DELETE</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// 删除醒目留言</span>
                <span class="token class-name">SendSmsReplyMsg</span> sendSmsReplyMsg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SendSmsReplyMsg</span><span class="token punctuation">)</span> cmdMsg<span class="token punctuation">;</span>
                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-1-client模式" tabindex="-1"><a class="header-anchor" href="#_2-1-client模式" aria-hidden="true">#</a> 2.1 Client模式</h3>`,4),B={href:"https://github.com/OrdinaryRoad-Project/ordinaryroad-live-chat-client/tree/main/live-chat-client-examples/client-example",target:"_blank",rel:"noopener noreferrer"},D=e(`<ol><li>创建配置</li><li>创建Client并传入配置、添加消息回调</li><li>开始监听直播间</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClientModeExample</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> cookie <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string">&quot;cookie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 1. 创建配置</span>
        <span class="token class-name">BilibiliLiveChatClientConfig</span> config <span class="token operator">=</span> <span class="token class-name">BilibiliLiveChatClientConfig</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// TODO 浏览器Cookie</span>
                <span class="token punctuation">.</span><span class="token function">cookie</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span>
                <span class="token comment">// TODO 直播间id（支持短id）</span>
                <span class="token punctuation">.</span><span class="token function">roomId</span><span class="token punctuation">(</span><span class="token number">7777</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 2. 创建Client并传入配置、添加消息回调</span>
        <span class="token class-name">BilibiliLiveChatClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BilibiliLiveChatClient</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">IBilibiliMsgListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDanmuMsg</span><span class="token punctuation">(</span><span class="token class-name">BilibiliBinaryFrameHandler</span> binaryFrameHandler<span class="token punctuation">,</span> <span class="token class-name">DanmuMsgMsg</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">IBilibiliMsgListener</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onDanmuMsg</span><span class="token punctuation">(</span>binaryFrameHandler<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s 收到弹幕 %s %s(%s)：%s\\n&quot;</span><span class="token punctuation">,</span> binaryFrameHandler<span class="token punctuation">.</span><span class="token function">getRoomId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getBadgeLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">?</span> msg<span class="token punctuation">.</span><span class="token function">getBadgeLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> msg<span class="token punctuation">.</span><span class="token function">getBadgeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onGiftMsg</span><span class="token punctuation">(</span><span class="token class-name">BilibiliBinaryFrameHandler</span> binaryFrameHandler<span class="token punctuation">,</span> <span class="token class-name">SendGiftMsg</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">IBilibiliMsgListener</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onGiftMsg</span><span class="token punctuation">(</span>binaryFrameHandler<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s 收到礼物 %s %s(%s) %s %s(%s)x%s(%s)\\n&quot;</span><span class="token punctuation">,</span> binaryFrameHandler<span class="token punctuation">.</span><span class="token function">getRoomId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getBadgeLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">?</span> msg<span class="token punctuation">.</span><span class="token function">getBadgeLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> msg<span class="token punctuation">.</span><span class="token function">getBadgeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getGiftName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getGiftId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getGiftCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getGiftPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3. 开始监听直播间</span>
        client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 客户端连接状态回调</span>
        client<span class="token punctuation">.</span><span class="token function">addStatusChangeListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PropertyChangeListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">propertyChange</span><span class="token punctuation">(</span><span class="token class-name">PropertyChangeEvent</span> evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>evt<span class="token punctuation">.</span><span class="token function">getNewValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">ClientStatusEnums</span><span class="token punctuation">.</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// TODO 要发送的弹幕内容，请注意控制发送频率；框架内置支持设置发送弹幕的最少时间间隔，小于时将忽略该次发送</span>
                    client<span class="token punctuation">.</span><span class="token function">sendDanmu</span><span class="token punctuation">(</span><span class="token string">&quot;666666&quot;</span> <span class="token operator">+</span> <span class="token class-name">RandomUtil</span><span class="token punctuation">.</span><span class="token function">randomNumbers</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-高级模式" tabindex="-1"><a class="header-anchor" href="#_2-2-高级模式" aria-hidden="true">#</a> 2.2 高级模式</h3>`,3),w={href:"https://github.com/OrdinaryRoad-Project/ordinaryroad-live-chat-client/tree/main/live-chat-client-examples/handler-example/src/main/java/tech/ordinaryroad/live/chat/client/example/handler/BilibiliHandlerModeExample.java",target:"_blank",rel:"noopener noreferrer"},L=e('<h2 id="_3-项目说明" tabindex="-1"><a class="header-anchor" href="#_3-项目说明" aria-hidden="true">#</a> 3 项目说明</h2><ul><li>commons（主要是抽象接口、抽象类的定义） <ul><li>commons-base <ul><li>定义了一些基础的接口、抽象类：消息、消息监听器、连接连监听器</li><li>消息接口 <ul><li>IMsg：所有msg都应该继承该类 <ul><li>ICmdMsg：有些平台的一些消息正文中没有消息类型cmd字段，例如B站的心跳包，因此再细分为cmdMsg</li><li>IDanmuMsg: 内置获取用户ID、用户名、用户头像、粉丝牌名称、粉丝牌等级、弹幕内容等方法 <ul><li>ISuperChatMsg：醒目留言，内置获取持续时间方法</li></ul></li><li>IGiftMsg：内置获取发送方ID、发送方用户名、发送方头像、接收方ID、接收方用户名、礼物名称、礼物图片、礼物ID、礼物个数、礼物单价等方法</li></ul></li></ul></li><li>消息抽象类 <ul><li>BaseMsg：实现IMsg接口，提供存放未知属性的字段 <ul><li>BaseCmdMsg：继承自BaseMsg，实现ICmdMsg接口</li></ul></li></ul></li><li>消息监听器 <ul><li>IBaseMsgListener（所有平台都支持，其他消息监听器存在平台差异） <ul><li>onMsg：所有消息（不管消息内容）都会调用，不包括由该消息的某个字段派生出的消息，例如快手的弹幕礼物等消息是<code>SC_FEED_PUSH</code>中的字段，因此onMsg中不会出现处理后的弹幕、礼物消息，而是包含弹幕、礼物等的<code>SCWebFeedPush</code>CMD消息</li><li>onCmdMsg：cmd消息（消息体中有表示消息类型的字段时），并且该类型需要处理（例如心跳回复包不需要处理）时调用</li><li>onOtherCmdMsg：该消息类型不需要处理（例如PK、点赞数更新等类型）时调用</li><li>onUnknownCmd：该消息类型未知（没有对应的枚举类）时调用</li></ul></li><li>IDanmuMsgListener（所有平台） <ul><li>onDanmuMsg：收到弹幕消息</li></ul></li><li>IGiftMsgListener（所有平台，快手礼物消息不全，缺少礼物单价、礼物个数、接收方信息、发送方粉丝牌信息） <ul><li>onGiftMsg：收到礼物消息</li></ul></li><li>ISuperChatMsgListener（B站） <ul><li>onSuperChatMsg：收到醒目留言</li></ul></li><li>IEnterRoomMsgListener（B站、斗鱼、抖音，虎牙只能接收到高级用户的入房回调） <ul><li>onEnterRoomMsg：进入房间消息回调</li></ul></li></ul></li></ul></li><li>commons-client <ul><li>定义了Client的配置：连接地址、房间id、Cookie、心跳、自动重连等相关参数</li><li>定义了Client的一些方法：初始化、销毁、连接、断开、添加消息回调、移除消息回调、发送弹幕等</li><li>定义了Client的生命周期</li></ul></li><li>commons-util <ul><li>一些工具类：时间、反射、Cookie</li></ul></li></ul></li><li>servers（对使用的连接工具的抽象） <ul><li>servers-netty <ul><li>定义了连接处理Handler</li><li>定义了数据处理Handler</li></ul></li><li>servers-netty-client（基于netty实现的Client） <ul><li>扩展了Client、ClientConfig</li><li>扩展Handler增加了Client成员变量</li></ul></li></ul></li><li>clients（对servers-netty-client的具体实现） <ul><li>client-bilibili</li><li>client-douyu</li><li>client-huya</li><li>client-douyin</li><li>client-kuaishou</li></ul></li></ul><h2 id="交流讨论" tabindex="-1"><a class="header-anchor" href="#交流讨论" aria-hidden="true">#</a> 交流讨论</h2>',3),S=n("img",{src:"https://github.com/OrdinaryRoad-Project/ordinaryroad-live-chat-client/blob/main/assets/QQ频道.jpg?raw=true",width:"200px"},null,-1),E=n("br",null,null,-1),O={href:"https://pd.qq.com/s/3id0n7fvs",target:"_blank",rel:"noopener noreferrer"},R=n("h2",{id:"感谢",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#感谢","aria-hidden":"true"},"#"),s(" 感谢")],-1),q={href:"https://github.com/cj1128/douyu-crawler-demo",target:"_blank",rel:"noopener noreferrer"},P={href:"https://githubfast.com/Kain-90/huya-danmu",target:"_blank",rel:"noopener noreferrer"},F=n("br",null,null,-1),H={href:"https://a.msstatic.com/huya/h5player/room/2309271152/vplayerUI.js",target:"_blank",rel:"noopener noreferrer"},U={href:"https://hd2.huya.com/fedbasic/huyabaselibs/taf-signal/taf-signal.global.0.0.4.prod.js",target:"_blank",rel:"noopener noreferrer"},G={href:"https://github.com/saermart/DouyinLiveWebFetcher",target:"_blank",rel:"noopener noreferrer"},N=n("h2",{id:"免责声明",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#免责声明","aria-hidden":"true"},"#"),s(" 免责声明")],-1),T=n("p",null,"免责声明：仅供学术研究使用。对于违反相关法律、造成危害的滥用行为，开发者不负任何责任。",-1);function Q(A,K){const a=i("ExternalLinkIcon");return c(),p("div",null,[u,n("blockquote",null,[n("p",null,[s("This project is in progress... 👨‍💻，有问题欢迎"),n("a",d,[s("提交issuse"),t(a)]),s("，"),k,s(" 觉得有用的话可以点个小星星⭐️鼓励一下，感谢")]),n("p",null,[s("如果对项目感兴趣也欢迎"),n("a",r,[s("加入QQ频道"),t(a)]),s("交流讨论，"),m,s(" 提交PR")]),n("p",null,[s("ToDo List: "),n("a",b,[s("https://github.com/orgs/OrdinaryRoad-Project/projects/1"),t(a)])])]),h,n("h2",g,[v,s(),n("a",y,[s("⭐BarrageFly——让弹幕飞"),t(a)]),s("，基于该项目的一个弹幕转发、过滤、处理平台")]),f,n("ul",null,[n("li",null,[s("B站："),n("a",_,[s("BilibiliCmdEnum"),t(a)])]),n("li",null,[s("斗鱼："),n("a",x,[s("DouyuCmdEnum"),t(a)])]),n("li",null,[s("虎牙："),n("a",C,[s("HuyaCmdEnum"),t(a)])]),n("li",null,[s("抖音："),n("a",M,[s("DouyinCmdEnum"),t(a)])]),n("li",null,[s("快手："),n("a",I,[s("PayloadTypeOuterClass"),t(a)])])]),j,n("blockquote",null,[n("p",null,[s("Spring Boot 示例 "),n("a",B,[s("client-example"),t(a)])])]),D,n("blockquote",null,[n("p",null,[s("参考 "),n("a",w,[s("BilibiliHandlerModeExample"),t(a)])])]),L,n("p",null,[s("扫描二维码"),S,E,s(" 或点击链接加入QQ频道【OrdinaryRoad】："),n("a",O,[s("https://pd.qq.com/s/3id0n7fvs"),t(a)])]),R,n("ul",null,[n("li",null,[n("a",q,[s("douyu-crawler-demo"),t(a)]),s("（斗鱼登录状态的请求包构建）")]),n("li",null,[n("a",P,[s("Kain-90/huya-danmu"),t(a)]),F,s(" （虎牙流程参考，最新lib库"),n("a",H,[s("vplayerUI.js"),t(a)]),s("、"),n("a",U,[s("taf-signal.global.0.0.4.prod.js"),t(a)]),s("）")]),n("li",null,[n("a",G,[s("saermart/DouyinLiveWebFetcher"),t(a)]),s("（抖音流程参考）")])]),N,T])}const $=l(o,[["render",Q],["__file","index.html.vue"]]);export{$ as default};
